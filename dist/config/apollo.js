"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startApolloServer=void 0;var b=j(require("express")),c=j(require("http")),d=j(require("compression")),e=j(require("graphql-depth-limit")),f=require("apollo-server-express"),g=require("apollo-server-core"),h=require("graphql-upload"),i=require("./context");function j(a){return a&&a.__esModule?a:{default:a}}const k=process.env.PORT||4e3,l={maxFileSize:3145728,maxFiles:5},a=async m=>{let a=b.default(),n=c.default.createServer(a),j=new f.ApolloServer({context:i.context,schema:m,plugins:[g.ApolloServerPluginDrainHttpServer({httpServer:n})],validationRules:[e.default(10)],formatError:a=>a});return await j.start(),a.use(h.graphqlUploadExpress(l)),a.use(d.default()),j.applyMiddleware({app:a}),await new Promise(a=>n.listen({port:k},a)),{url:`http://localhost:${k}${j.graphqlPath}`,server:j,app:a}};exports.startApolloServer=a
//# sourceMappingURL=apollo.js.map