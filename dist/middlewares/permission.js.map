{"version":3,"sources":["../../src/middlewares/permission.ts"],"sourcesContent":["import { rule, shield } from 'graphql-shield';\r\n\r\nconst isAuthenticated = rule({ cache: 'contextual' })(\r\n  async (parent, args, ctx, info) => {\r\n    return ctx.user !== null;\r\n  }\r\n);\r\n\r\nconst isAdmin = rule({ cache: 'contextual' })(\r\n  async (parent, args, ctx, info) => {\r\n    return ctx.user.role === 'admin';\r\n  }\r\n);\r\n\r\n// Permissions\r\nexport const permissions = shield(\r\n  {\r\n    Query: {\r\n      hello: isAuthenticated,\r\n    },\r\n  },\r\n  {\r\n    allowExternalErrors: process.env.NODE_ENV === 'production',\r\n  }\r\n);\r\n"],"names":["isAuthenticated","rule","cache","parent","args","ctx","info","user","role","permissions","shield","Query","hello","allowExternalErrors","process","env","NODE_ENV"],"mappings":"AAAA,8FAA6B,KAAA,CAAgB,SAAhB,gBAAgB,CAAA,AAE7C,OAAMA,CAAe,CAAGC,CAAI,KAAA,CAAC,CAAEC,KAAK,CAAE,YAAY,CAAE,CAAC,CACnD,MAAOC,CAAM,CAAEC,CAAI,CAAEC,CAAG,CAAEC,CAAI,GACrBD,AAAa,IAAI,GAAjBA,CAAG,CAACE,IAAI,AAAS,AACzB,CACF,AAAC,AAEcN,CAAAA,CAAI,KAAA,CAAC,CAAEC,KAAK,CAAE,YAAY,CAAE,CAAC,CAC3C,MAAOC,CAAM,CAAEC,CAAI,CAAEC,CAAG,CAAEC,CAAI,GACrBD,AAAkB,OAAO,GAAzBA,CAAG,CAACE,IAAI,CAACC,IAAI,AAAY,AACjC,CACF,AAGM,OAAMC,CAAW,CAAGC,CAAM,OAAA,CAC/B,CACEC,KAAK,CAAE,CACLC,KAAK,CAAEZ,CAAe,CACvB,CACF,CACD,CACEa,mBAAmB,CAAEC,AAAyB,YAAY,GAArCA,OAAO,CAACC,GAAG,CAACC,QAAQ,AAAiB,CAC3D,CACF,AAAC,SATWP,WAAW,CAAXA,CAAW,AAStB"}